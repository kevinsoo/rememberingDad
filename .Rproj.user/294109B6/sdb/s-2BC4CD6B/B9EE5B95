{
    "collab_server" : "",
    "contents" : "##############################################################\n#### Scrapes all articles by Soo Ewe Jin from The Star website\n#### Author: Kevin Soo\n##############################################################\n\n# load libraries\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(rvest)\n\n# for each result page\nfor (i in 1:37) {\n    # scrape name, date, url\n    pages <- paste(\"http://www.thestar.com.my/authors/?q=%22Soo+Ewe+Jin%22&pgno=\", i, sep=\"\")\n    article <- read_html(pages) %>% html_nodes(\"#slcontent3_3_sleft_0_pnlAuthorsList a\") %>% html_text()\n    date <- read_html(pages) %>% html_nodes(\".date\") %>% html_text()\n    link <- read_html(pages) %>% html_nodes(\"#slcontent3_3_sleft_0_pnlAuthorsList a\") %>% html_attr('href')\n    \n    # combine into data frame\n    date <- date[2:length(date)]\n    temp <- data.frame(article, date, link)\n    if (i==1) { ej <- temp }\n    else { ej <- rbind(ej, temp)}\n}\n\n# format links and titles\nej$url <- NA\nej$title <- NA\nfor (i in 1:nrow(ej)) {\n    ej$url[i] <- paste(\"http://www.thestar.com.my\", ej$link[i], sep=\"\")\n    # clean html\n    ej$title[i] <- gsub(\"â\\u0080\\u0098\", \"'\", \n                        gsub(\"â\\u0080\\u0099\", \"'\", \n                             gsub(\"â\\u0080\\u0094\", \"-\", \n                                  gsub(\"â\\u0080\\u0093\", \"-\", \n                                       gsub(\" &#8212;\", \"; \",\n                                            gsub(\"&#8216;\", \"'\",\n                                                 gsub(\"&#8217;\", \"'\",\n                                                      gsub(\"â\\u0080\\u0098\", \"'\",\n                                                                ej$article[i]))))))))\n}\nej <- ej %>% select(-link, -article)\n\n# categorize each article\nej$category <- NA\nfor (i in 1:nrow(ej)) {\n    if(str_detect(ej$url[i], \"/columnists/\")==TRUE) { ej$category[i] <- \"Column\" }\n    else if(str_detect(ej$url[i], \"/business-news/\")==TRUE) { ej$category[i] <- \"Business\" }\n    else { ej$category[i] <- \"Other\" }\n}\n\n# scrape text of each article\nej$text <- NA\nej$paragraphs <- NA\nfor (i in 1:nrow(ej)) {\n    txt <- read_html(ej$url[i]) %>% html_nodes(\"#slcontent3_5_sleft_0_storyDiv p\") %>% html_text()\n    tmp <- paste(txt, collapse=\" \")\n    ej$paragraphs[i] <- length(txt)\n    # clean html\n    ej$text[i] <- gsub(\"\\n\", \"\", \n                       gsub(\"Â\", \"\",\n                            gsub(\"â\\u0080\\u0098\", \"'\", \n                                 gsub(\"â\\u0080\\u0099\", \"'\", \n                                      gsub(\"â\\u0080\\u0094\", \"-\", \n                                           gsub(\"â\\u0080\\u0093\", \"-\", \n                                                gsub(\" &#8212;\", \"; \",\n                                                     gsub(\"&#8216;\", \"'\",\n                                                          gsub(\"&#8217;\", \"'\",\n                                                               gsub(\"â\\u0080\\u0098\", \"'\",\n                                                                    tmp))))))))))\n}\n\n# format columns\nej$category <- as.factor(ej$category)\nej$title <- as.factor(ej$title)\nej$date <- as.Date(ej$date, format=\"%d %B %Y\")\n\n# save date\nsave(ej, file=\"ejStar.Rda\")\n",
    "created" : 1479725487716.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "856570611",
    "id" : "B9EE5B95",
    "lastKnownWriteTime" : 1479835922,
    "last_content_update" : 1479835922278,
    "path" : "~/Box Sync/Personal/rememberingDad/scrape_articles.R",
    "project_path" : "scrape_articles.R",
    "properties" : {
        "docOutlineVisible" : "0",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}