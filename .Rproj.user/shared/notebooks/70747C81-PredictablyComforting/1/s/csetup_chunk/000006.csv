"0","knitr::opts_chunk$set(echo = TRUE)"
"0","# load packages"
"0","library(tidyverse)"
"0","library(reshape2)"
"0","library(ggthemes)"
"0","library(tm)"
"0","library(SnowballC)"
"0","library(wordcloud)"
"0","library(cluster)"
"0","library(fpc)"
"0","# load data"
"0","load(file=""ejStar.Rda"")"
"0","######### pre-processing text"
"0","# create corpus"
"0","corpus <- Corpus(VectorSource(ej$text))"
"0","# preprocessing"
"0","corpus <- tm_map(corpus, removePunctuation) "
"0","corpus <- tm_map(corpus, removeNumbers)"
"0","corpus <- tm_map(corpus, tolower)"
"0","# inspect(corpus)[[1]][1]"
"0","# remove stopwords"
"0","corpus <- tm_map(corpus, removeWords, stopwords(""english""))"
"0","minorwords <- c(""soo"", ""ewe"", ""jin"", ""executive"", ""editor"", ""Ã¢"") # remove specific words here"
"0","corpus <- tm_map(corpus, removeWords, minorwords)"
"0","# remove stems and whitespace"
"0","corpus <- tm_map(corpus, stemDocument)"
"0","corpus <- tm_map(corpus, stripWhitespace)"
"0","# save as text document"
"0","corpus <- tm_map(corpus, PlainTextDocument)"
"0","# create document term matrix"
"0","dtm <- DocumentTermMatrix(corpus)"
"0","tdm <- TermDocumentMatrix(corpus)"
"0","########## reshape data for plotting"
"0","# word frequencies"
"0","freq <- colSums(as.matrix(dtm))   "
"0","# remove sparse words"
"0","dtms <- removeSparseTerms(dtm, 0.5) # 50% empty space, maximum"
"0","rownames(dtms) <- ej$title # document titles"
"0","# data frame of frequencies"
"0","wf <- data.frame(word=names(freq), freq=freq) %>% arrange(-freq)"
"0","wf$rank <- 1:nrow(wf)"
"0","wf$word <- factor(wf$word, levels=wf[order(wf$rank),""word""])"
"0","# set up family data frame"
"0","family <- wf %>% filter(word %in% c(""kevin"", ""tim"", ""son"", ""wife"", ""angie"", ""evelyn""))"
"0","# create dendrogram"
"0","d <- dist(t(dtms), method=""euclidian"")   "
"0","fit <- hclust(d=d, method=""ward.D"")  "
"0","# data frame of distances"
"0","meltedWords <- data.frame(melt(as.matrix(d)))"
"0","colnames(meltedWords) <- c(""i"", ""j"", ""Distance"")"
"0","# load topic modeling data"
"0","load(file=""topics.Rda"")"
"0","topics$section <- ej$category"
"0","# topics in long format"
"0","topicsOverTime <- topics %>% gather(topics, p, Encouragement:Society) %>% arrange(num, topics)"
